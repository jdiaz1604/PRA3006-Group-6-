<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Interactive Map · Endemic Species & Economy Explorer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <!-- Header + nav shared across pages; sets context before the interactive map. -->
    <h1>Investigating Socioeconomic Impact on Species Endangerment</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="map.html" class="active">Interactive map</a>
      <a href="correlations.html">Correlations</a>
      <a href="contact.html">Contact</a>
    </nav>
  </header>

  <main class="map-shell">
    <!-- Layout overview: SVG map workspace on the left, data/metrics sidebar on the right. -->
    <div class="map-panel">
      <div class="map-toolbar">
        <span class="panel-label" id="panelMode">Continent overview</span>
        <button class="btn btn-outline" id="backToWorld" disabled>Back to continents</button>
      </div>
      <div class="app">
        <div class="map-wrap">
          <svg class="map"></svg>
          <div class="loading" id="loading" aria-hidden="true" style="display:none;"><div class="spinner"></div></div>
          <div class="tooltip" id="tooltip"></div>
          <div class="biome-legend">
            <h4>Biome colors</h4>
            <div class="biome-item"><div class="biome-color biome-forest"></div><span>Forest</span></div>
            <div class="biome-item"><div class="biome-color biome-rainforest"></div><span>Rainforest</span></div>
            <div class="biome-item"><div class="biome-color biome-grassland"></div><span>Grassland/Savanna</span></div>
            <div class="biome-item"><div class="biome-color biome-desert"></div><span>Desert</span></div>
            <div class="biome-item"><div class="biome-color biome-tundra"></div><span>Tundra</span></div>
            <div class="biome-item"><div class="biome-color biome-ice"></div><span>Ice/Polar</span></div>
            <div class="biome-item"><div class="biome-color biome-mountain"></div><span>Mountain</span></div>
            <div class="biome-item"><div class="biome-color biome-mediterranean"></div><span>Mediterranean</span></div>
          </div>
        </div>
        <aside class="sidebar">
          <h2 id="country-title">Click a country</h2>
          <p class="small" id="dataContext">The panel will show:</p>
          

          <div class="metric">
            <div class="metric-label">Total endemic species</div>
            <div class="metric-value" id="totalEndemic">—</div>
            <div class="status" id="endemicStatus"></div>
          </div>
          <div class="metric">
            <div class="metric-label">Threatened endemic species</div>
            <div class="metric-value" id="endangeredEndemic">—</div>
          </div>

        <!-- Right column: Data information panel -->
        <aside class="sidebar"> <!-- Semantic element for supplementary content -->
          <h2 id="country-title">Click a Continent</h2> <!-- Dynamic title updated by JavaScript -->
          <p class="small" id="dataContext">The panel will show:</p> <!-- Context description -->
          
          <!-- Species data metrics -->
          <div class="metric"> <!-- Container for a single data metric -->
            <div class="metric-label">Total endemic species</div> <!-- Metric description -->
            <div class="metric-value" id="totalEndemic">—</div> <!-- Dynamic value, initially placeholder -->
            <div class="status" id="endemicStatus"></div> <!-- Optional status indicator (trend, etc.) -->
          </div> <!-- End of total endemic species metric -->
          
          <div class="metric"> <!-- Another metric container -->
            <div class="metric-label">Threatened endemic species</div> <!-- Description -->
            <div class="metric-value" id="endangeredEndemic">—</div> <!-- Dynamic value placeholder -->
          </div> <!-- End of threatened species metric -->

          <!-- Chart container and description -->
          <div id="chart" style="margin:10px 0 6px;"></div> <!-- Empty div where D3.js will insert pie chart -->
          <div class="legend">Pie: endemic species by IUCN category (NT, VU, EN, CR, other)</div> <!-- Chart explanation -->
          
          <!-- Economic and demographic metrics -->
          <div class="metric" style="margin-top:18px;"> <!-- GDP metric with top margin -->
            <div class="metric-label">Latest nominal GDP (USD)</div> <!-- Description -->
            <div class="metric-value" id="gdp">—</div> <!-- Dynamic GDP value -->
            <div class="small" id="gdpYear"></div> <!-- Year of GDP data -->
            <div class="status" id="gdpStatus"></div> <!-- Status indicator -->
          </div> <!-- End of GDP metric -->
          
          <div class="metric"> <!-- Population metric -->
            <div class="metric-label">Latest population</div> <!-- Description -->
            <div class="metric-value" id="population">—</div> <!-- Dynamic population value -->
            <div class="small" id="popYear"></div> <!-- Year of population data -->
            <div class="status" id="popStatus"></div> <!-- Status indicator -->
          </div> <!-- End of population metric -->

          <!-- Data source and attribution information -->
          <div class="note">Data source: QLever Wikidata (live). Tables are fetched once and filtered client-side.</div> <!-- Data source note -->
          <div class="attribution"> <!-- Attribution for map libraries -->
            Map © <a href="https://github.com/topojson/world-atlas" target="_blank" rel="noopener">world-atlas</a> · <!-- Map data source -->
            Built with <a href="https://d3js.org/" target="_blank" rel="noopener">D3</a>. <!-- Visualization library -->
          </div> <!-- End of attribution -->
        </aside> <!-- End of sidebar -->
      </div> <!-- End of app (two-column layout) -->
    </div> <!-- End of map-panel -->
  </main> <!-- End of main content -->

  <!-- External assets: D3 for rendering and interactions, TopoJSON for map data conversion, map.js for all map logic and SPARQL data loading. -->
  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
  <script src="https://cdn.jsdelivr.net/npm/topojson-client@3"></script>
  <script src="map.js"></script>
</body>
</html>
